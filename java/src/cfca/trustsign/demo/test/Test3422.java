package cfca.trustsign.demo.test;

import cfca.sadk.algorithm.common.PKIException;
import cfca.trustsign.common.vo.cs.DataSignVO;
import cfca.trustsign.common.vo.cs.HeadVO;
import cfca.trustsign.common.vo.request.tx3.Tx3422ReqVO;
import cfca.trustsign.demo.connector.HttpConnector;
import cfca.trustsign.demo.constant.Request;
import cfca.trustsign.demo.converter.JsonObjectMapper;
import cfca.trustsign.demo.util.SecurityUtil;
import cfca.trustsign.demo.util.TimeUtil;

public class Test3422 {
    public static void main(String[] args) throws PKIException {
        HttpConnector httpConnector = new HttpConnector();
        httpConnector.init();

        Tx3422ReqVO tx3422ReqVO = new Tx3422ReqVO();
        HeadVO head = new HeadVO();
        head.setTxTime(TimeUtil.getCurrentTime(TimeUtil.FORMAT_14));

        DataSignVO dataSign = new DataSignVO();
        dataSign.setStubNo("007");
        dataSign.setSignedData(
                "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");

        tx3422ReqVO.setHead(head);
        tx3422ReqVO.setDataSign(dataSign);

        JsonObjectMapper jsonObjectMapper = new JsonObjectMapper();
        String req = jsonObjectMapper.writeValueAsString(tx3422ReqVO);
        System.out.println("req:" + req);

        String txCode = "3422";
        String signature = SecurityUtil.p7SignMessageDetach(HttpConnector.JKS_PATH, HttpConnector.JKS_PWD, HttpConnector.ALIAS, req);
        String res = httpConnector.post("platId/" + Request.PLAT_ID + "/txCode/" + txCode + "/transaction", req, signature);
        System.out.println("res:" + res);
    }
}
